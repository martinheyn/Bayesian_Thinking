---
title: "Rethinking Chapter 4"
output: html_notebook
---
- Linear regression is the geocentric model of applied statistics.

# Normal by addition
R-Code 4.1
```{r}
pos <- replicate(1000, sum( runif(16,-1,1)))
#adjust plot margins
hist(pos)
plot(density(pos))
```
# Normal by multiplication
- Multiplying small numbers is approximately the same as addition.
- The interacting growth deviations, as long as they are sufficiently small, converge to a Gaussian distribution.


R-Code 4.2
```{r}
# Sample a random growth rate 
# This code samples 12 random numbers between 1 and 1.1.
prod (1 + runif(12,0,0.1))

# And this code generates 10.000 of these numbers
growth <-replicate(10000,prod(1+runif(12,0,0.01)))
library(rethinking)
dens( growth,norm.comp=TRUE)
```
# Normal by log-multiplication
- Multiplicative interactions of large deviations can produce Gaussian distributions, once we measure the outcomes on the log scale.

R-Code 4.5
```{r}
log.big <-replicate(10000,log(prod(1+runif(12,0,0.5))))
dens(log.big,norm.comp=TRUE)
```
# From model definition to Bayes' theorem
R-Code 4.6
```{r}
w <- 6; n <- 9;
p_grid <- seq(from=0,to=1,length.out=100)
posterior <- dbinom(w,n,p_grid)*dunif(p_grid,0,1)
posterior <- posterior/sum(posterior)
```

# Gaussian model of height
## Get the test data
R-code 4.7
```{r}
library(rethinking)
data(Howell1)
d <- Howell1

str(d) # Inspects the structure of the data frame
precis(d,hist=FALSE)

d$height # Extracts the height as R vector

d2 <- d[ d$age >= 18, ] # Extract individuals of age 18 or greater

precis(d2,hist=FALSE)

dens(d$height) # Plot the distribution of heights

curve(dnorm(x, 187, 20), from=100, to=250) # Plot prior for mu
curve(dunif(x, 0, 50), from =-10, to=60) # Plot prior for sigma

# And now sample from prior to simulate heights
sample_mu <- rnorm(1e4, 187, 20)
sample_sigma <- runif(1e4, 0, 50)
prior_h <- rnorm(1e4, sample_mu, sample_sigma)
dens(prior_h)

# And now with a prior that is much flatter and less informative prior
sample_mu <- rnorm(1e4, 187, 100)
prior_h <- rnorm(1e4, sample_mu, sample_sigma)
dens(prior_h)
```

